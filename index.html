<!DOCTYPE html>


<html lang="zh-Hans">
  

    <head>
      <meta charset="utf-8" />
        
      <meta name="description" content="Blog of Alin" />
      
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title> Alin</title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="/favicon.ico" />
       
<link rel="stylesheet" href="/dist/main.css">

      
<link rel="stylesheet" href="/css/fonts/remixicon.css">

      
<link rel="stylesheet" href="/css/custom.css">
 
      <script src="https://cdn.staticfile.org/pace/1.2.4/pace.min.js"></script>
       
 

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma@5.0.1/bulma.min.css"
      />
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>

      <!-- mermaid -->
      
      <style>
        .swal2-styled.swal2-confirm {
          font-size: 1.6rem;
        }
      </style>
    </head>
  </html>
</html>


<body>
  <div id="app">
    
      
    <main class="content on">
      
<section class="cover">
    
      
      <a class="forkMe" href="https://github.com/Shen-Yu/hexo-theme-ayer"
        target="_blank"><img width="149" height="149" src="/images/forkme.png"
          class="attachment-full size-full" alt="Fork me on GitHub" data-recalc-dims="1"></a>
    
  <div class="cover-frame">
    <div class="bg-box">
      <img src="/images/cover1.jpg" alt="image frame" />
    </div>
    <div class="cover-inner text-center text-white">
      <h1><a href="/">Alin</a></h1>
      <div id="subtitle-box">
        
        <span id="subtitle"></span>
        
      </div>
      <div>
        
      </div>
    </div>
  </div>
  <div class="cover-learn-more">
    <a href="javascript:void(0)" class="anchor"><i class="ri-arrow-down-line"></i></a>
  </div>
</section>



<script src="https://cdn.staticfile.org/typed.js/2.0.12/typed.min.js"></script>


<!-- Subtitle -->

  <script>
    try {
      var typed = new Typed("#subtitle", {
        strings: ['面朝大海，春暖花开', '愿你一生努力，一生被爱', '想要的都拥有，得不到的都释怀'],
        startDelay: 0,
        typeSpeed: 200,
        loop: true,
        backSpeed: 100,
        showCursor: true
      });
    } catch (err) {
      console.log(err)
    }
  </script>
  
<div id="main">
  <section class="outer">
  
  
  

<div class="notice" style="margin-top:50px">
    <i class="ri-heart-fill"></i>
    <div class="notice-content" id="broad"></div>
</div>
<script type="text/javascript">
    fetch('https://v1.hitokoto.cn')
        .then(response => response.json())
        .then(data => {
            document.getElementById("broad").innerHTML = data.hitokoto;
        })
        .catch(console.error)
</script>

<style>
    .notice {
        padding: 20px;
        border: 1px dashed #e6e6e6;
        color: #969696;
        position: relative;
        display: inline-block;
        width: 100%;
        background: #fbfbfb50;
        border-radius: 10px;
    }

    .notice i {
        float: left;
        color: #999;
        font-size: 16px;
        padding-right: 10px;
        vertical-align: middle;
        margin-top: -2px;
    }

    .notice-content {
        display: initial;
        vertical-align: middle;
    }
</style>
  
  <article class="articles">
    
    
    
    
    <article
  id="post-操作系统"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/07/08/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"
    >操作系统</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/07/08/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" class="article-date">
  <time datetime="2022-07-08T14:16:00.000Z" itemprop="datePublished">2022-07-08</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="进程和线程的区别？"><a href="#进程和线程的区别？" class="headerlink" title="进程和线程的区别？"></a>进程和线程的区别？</h2><ul>
<li>进程是资源管理的基本单位，线程是程序执行的基本单位。</li>
<li>进程是拥有资源的一个独立单位，线程不拥有系统资源，但是可以访问隶属于进程的资源。</li>
</ul>
<h2 id="线程和协程的区别？"><a href="#线程和协程的区别？" class="headerlink" title="线程和协程的区别？"></a>线程和协程的区别？</h2><ul>
<li>线程和进程是同步机制，而协程是异步机制。</li>
<li>线程调度靠系统内核管理，协程由用户控制。</li>
<li>协程的执行效率比线程高。</li>
</ul>
<p><img src="/2022/07/08/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F//1657209578801.png" alt="1657209578801"></p>
<h2 id="进程间通信方式有哪些？"><a href="#进程间通信方式有哪些？" class="headerlink" title="进程间通信方式有哪些？"></a>进程间通信方式有哪些？</h2><ul>
<li>信号量：信号量是一个<strong>计数器</strong> ，可以用来控制多个进程对共享资源的访问。</li>
<li>信号：一个进程可以向另外一个进程或者另外一组进程发送信号消息，通知目标进程执行特定的代码。</li>
<li>socket</li>
<li>共享内存</li>
<li>管道</li>
<li>消息队列</li>
</ul>
<h2 id="线程同步的方式有哪些？"><a href="#线程同步的方式有哪些？" class="headerlink" title="线程同步的方式有哪些？"></a>线程同步的方式有哪些？</h2><ul>
<li>互斥量：采用互斥对象机制，只有拥有互斥对象的线程才有访问公共资源的权限。因为互斥对象只有一个，所以可以保证公共资源不会被多个线程同时访问。</li>
</ul>
<ul>
<li>信号量：它允许同一时刻多个线程访问同一资源，但是需要控制同一时刻访问此资源的最大线程数量。</li>
<li>事件（信号）：通过通知操作的方式来保持多线程同步，还可以方便的实现多线程优先级的比较操作。</li>
</ul>
<h2 id="调度算法？"><a href="#调度算法？" class="headerlink" title="调度算法？"></a>调度算法？</h2><ul>
<li>先来先服务</li>
<li>最短作业优先</li>
<li>最短剩余时间优先</li>
<li>时间片轮询</li>
<li>优先级调度</li>
</ul>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" rel="tag">操作系统</a></li></ul>

    </footer>
  </div>

   
    
</article>

    
    <article
  id="post-计算机网络"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/07/08/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"
    >计算机网络</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/07/08/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" class="article-date">
  <time datetime="2022-07-08T14:16:00.000Z" itemprop="datePublished">2022-07-08</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="TCP-和-UDP-的区别"><a href="#TCP-和-UDP-的区别" class="headerlink" title="TCP 和 UDP 的区别"></a>TCP 和 UDP 的区别</h2><ul>
<li><p>TCP 面向连接，可靠传输，三次握手，四次挥手，面向字节流，有拥塞控制、流量控制</p>
</li>
<li><p>UDP 面向无连接，不可靠传输，面向报文，无拥塞控制、流量控制</p>
<p><img src="/2022/07/08/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C//image-20220516113504600.png" alt="image-20220516113504600"></p>
</li>
</ul>
<h2 id="浏览器输入-url-后，发生了什么"><a href="#浏览器输入-url-后，发生了什么" class="headerlink" title="浏览器输入 url 后，发生了什么"></a>浏览器输入 url 后，发生了什么</h2><ol>
<li>DNS 域名解析</li>
<li>建立 TCP 链接</li>
<li>发送 HTTP 请求</li>
<li>服务器处理请求，返回响应结果</li>
<li>关闭 TCP 连接</li>
<li>浏览器渲染解析 HTML</li>
</ol>
<h2 id="HTTP-和-HTTPS-的区别"><a href="#HTTP-和-HTTPS-的区别" class="headerlink" title="HTTP 和 HTTPS 的区别"></a>HTTP 和 HTTPS 的区别</h2><ul>
<li>https 需要 ca 申请 ssl 证书</li>
<li>http 是明文传输，而 https 是 ssl 加密传输，https 比 http 安全</li>
<li>http 使用 80 端口，https 使用 443 端口</li>
</ul>
<h2 id="对称加密和非对称加密的区别"><a href="#对称加密和非对称加密的区别" class="headerlink" title="对称加密和非对称加密的区别"></a>对称加密和非对称加密的区别</h2><p>对称加密：加密和解密是同一个密钥</p>
<p>非对称加密：公钥加密，私钥解密，两个不同的密钥。</p>
<h2 id="非对称加密"><a href="#非对称加密" class="headerlink" title="非对称加密"></a>非对称加密</h2><p>公钥加密，私钥解密</p>
<p><img src="/2022/07/08/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C//image-20220519140620778.png" alt="image-20220519140620778"></p>
<h2 id="状态码的含义"><a href="#状态码的含义" class="headerlink" title="状态码的含义"></a>状态码的含义</h2><ul>
<li>200，成功</li>
<li>301，永久重定向</li>
<li>302，临时重定向</li>
<li>400，用户请求有误</li>
<li>403，用户请求被禁止</li>
<li>404，用户访问的网页不存在</li>
<li>500，服务器内部错误</li>
</ul>
<h2 id="A-类、B-类等地址范围-全-0-表示本网络，全-1-表示广播地址-这两个不用分配"><a href="#A-类、B-类等地址范围-全-0-表示本网络，全-1-表示广播地址-这两个不用分配" class="headerlink" title="A 类、B 类等地址范围(全 0 表示本网络，全 1 表示广播地址)这两个不用分配"></a>A 类、B 类等地址范围(全 0 表示本网络，全 1 表示广播地址)这两个不用分配</h2><table>
<thead>
<tr>
<th>类别</th>
<th>可用范围</th>
<th>私有号段</th>
</tr>
</thead>
<tbody><tr>
<td>A 0</td>
<td>1.0.0.1-126.255.255.254</td>
<td>10.0.0.0-10.255.255.255</td>
</tr>
<tr>
<td>B 10</td>
<td>128.0.0.1-191.255.255.254</td>
<td>172.16.0.0-172.31.255.255</td>
</tr>
<tr>
<td>C 110</td>
<td>192.0.0.1-223.255.255.254</td>
<td>192.168.0.0-192.168.255.255</td>
</tr>
<tr>
<td>D 1110</td>
<td>224-239</td>
<td></td>
</tr>
<tr>
<td>E 1111</td>
<td>240-255</td>
<td></td>
</tr>
</tbody></table>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" rel="tag">计算机网络</a></li></ul>

    </footer>
  </div>

   
    
</article>

    
    <article
  id="post-mysql"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/07/08/mysql/"
    >mysql</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/07/08/mysql/" class="article-date">
  <time datetime="2022-07-08T14:13:27.000Z" itemprop="datePublished">2022-07-08</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h1><h2 id="建立-amp-amp-删除-amp-amp-使用数据库"><a href="#建立-amp-amp-删除-amp-amp-使用数据库" class="headerlink" title="建立&amp;&amp;删除&amp;&amp;使用数据库"></a>建立&amp;&amp;删除&amp;&amp;使用数据库</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> database xxx;</span><br><span class="line"><span class="keyword">drop</span> database xxx;</span><br><span class="line">use xxx;</span><br></pre></td></tr></table></figure>

<h2 id="创建表-amp-amp-删除表"><a href="#创建表-amp-amp-删除表" class="headerlink" title="创建表&amp;&amp;删除表"></a>创建表&amp;&amp;删除表</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">user</span>(</span><br><span class="line">id <span class="type">INT</span> UNSIGNED AUTO_INCREMENT,</span><br><span class="line">username <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line"><span class="keyword">PRIMARY</span> key(id)</span><br><span class="line">)ENGINE<span class="operator">=</span>INNODB <span class="keyword">DEFAULT</span> charset<span class="operator">=</span>utf8;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span>; # 删除表和结构</span><br><span class="line"><span class="keyword">truncate</span> <span class="keyword">table</span>; # 删除所有数据，保存表结构</span><br></pre></td></tr></table></figure>

<h2 id="插入数据"><a href="#插入数据" class="headerlink" title="插入数据"></a>插入数据</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">table</span> (id, username) <span class="keyword">values</span> (<span class="number">1</span>,<span class="string">&#x27;1&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> <span class="keyword">table</span> <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<h2 id="查询数据"><a href="#查询数据" class="headerlink" title="查询数据"></a>查询数据</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> column_name,column_name</span><br><span class="line"><span class="keyword">FROM</span> table_name</span><br><span class="line">[<span class="keyword">WHERE</span> Clause]</span><br><span class="line">[LIMIT N][ <span class="keyword">OFFSET</span> M]</span><br></pre></td></tr></table></figure>

<h2 id="limit-限制返回行数"><a href="#limit-限制返回行数" class="headerlink" title="limit 限制返回行数"></a>limit 限制返回行数</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> device_id</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line">limit <span class="number">0</span>,<span class="number">2</span>; #从<span class="number">0</span>开始，前面两个</span><br></pre></td></tr></table></figure>

<h2 id="不等于-lt-gt-x2F-x3D-，不是所以系统都可以用）"><a href="#不等于-lt-gt-x2F-x3D-，不是所以系统都可以用）" class="headerlink" title="不等于 &lt;&gt;&#x2F; (!&#x3D;，不是所以系统都可以用）"></a>不等于 &lt;&gt;&#x2F; (!&#x3D;，不是所以系统都可以用）</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> age,university</span><br><span class="line"><span class="keyword">from</span> user_profile</span><br><span class="line"><span class="keyword">where</span> university<span class="operator">&lt;&gt;</span><span class="string">&#x27;复旦大学&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h2 id="为空-is-null"><a href="#为空-is-null" class="headerlink" title="为空 is null"></a>为空 is null</h2><h2 id="不为空-is-not-null-x2F-lt-gt-“”"><a href="#不为空-is-not-null-x2F-lt-gt-“”" class="headerlink" title="不为空 is not null&#x2F; &lt;&gt; “”"></a>不为空 is not null&#x2F; &lt;&gt; “”</h2><h2 id="update-更新数据"><a href="#update-更新数据" class="headerlink" title="update 更新数据"></a>update 更新数据</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> table_name <span class="keyword">SET</span> field1<span class="operator">=</span><span class="keyword">new</span><span class="operator">-</span>value1, field2<span class="operator">=</span><span class="keyword">new</span><span class="operator">-</span>value2</span><br><span class="line">[<span class="keyword">WHERE</span> Clause]</span><br><span class="line"></span><br><span class="line"><span class="keyword">update</span> <span class="keyword">user</span> <span class="keyword">set</span> username<span class="operator">=</span><span class="string">&#x27;alin&#x27;</span> <span class="keyword">where</span> id<span class="operator">=</span><span class="number">6</span></span><br></pre></td></tr></table></figure>

<h2 id="like-查找数据"><a href="#like-查找数据" class="headerlink" title="like 查找数据"></a>like 查找数据</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> field1, field2,...fieldN</span><br><span class="line"><span class="keyword">FROM</span> table_name</span><br><span class="line"><span class="keyword">WHERE</span> field1 <span class="keyword">LIKE</span> condition1 [<span class="keyword">AND</span> [<span class="keyword">OR</span>]] filed2 <span class="operator">=</span> <span class="string">&#x27;somevalue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> `<span class="keyword">user</span>` <span class="keyword">WHERE</span> username <span class="keyword">like</span> <span class="string">&#x27;a%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;%a&#x27;</span>     <span class="operator">/</span><span class="operator">/</span>以a结尾的数据</span><br><span class="line"><span class="string">&#x27;a%&#x27;</span>     <span class="operator">/</span><span class="operator">/</span>以a开头的数据</span><br><span class="line"><span class="string">&#x27;%a%&#x27;</span>    <span class="operator">/</span><span class="operator">/</span>含有a的数据</span><br><span class="line"><span class="string">&#x27;_a_&#x27;</span>    <span class="operator">/</span><span class="operator">/</span>三位且中间字母是a的</span><br><span class="line"><span class="string">&#x27;_a&#x27;</span>     <span class="operator">/</span><span class="operator">/</span>两位且结尾字母是a的</span><br><span class="line"><span class="string">&#x27;a_&#x27;</span>     <span class="operator">/</span><span class="operator">/</span>两位且开头字母是a的</span><br></pre></td></tr></table></figure>

<h2 id="union-操作符，将不同的-select-结果组合到一个结果集中，expresssion-可以不同"><a href="#union-操作符，将不同的-select-结果组合到一个结果集中，expresssion-可以不同" class="headerlink" title="union 操作符，将不同的 select 结果组合到一个结果集中，expresssion 可以不同"></a>union 操作符，将不同的 select 结果组合到一个结果集中，expresssion 可以不同</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> expression1, expression2, ... expression_n</span><br><span class="line"><span class="keyword">FROM</span> tables</span><br><span class="line">[<span class="keyword">WHERE</span> conditions]</span><br><span class="line"><span class="keyword">UNION</span> [<span class="keyword">ALL</span> <span class="operator">|</span> <span class="keyword">DISTINCT</span>]</span><br><span class="line"><span class="keyword">SELECT</span> expression1, expression2, ... expression_n</span><br><span class="line"><span class="keyword">FROM</span> tables</span><br><span class="line">[<span class="keyword">WHERE</span> conditions];</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> id <span class="keyword">from</span> book</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> <span class="keyword">user</span>;</span><br></pre></td></tr></table></figure>

<h2 id="group-by：默认为-asc-升序"><a href="#group-by：默认为-asc-升序" class="headerlink" title="group by：默认为 asc 升序"></a>group by：默认为 asc 升序</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> field1, field2,...fieldN <span class="keyword">FROM</span> table_name1, table_name2...</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> field1 [<span class="keyword">ASC</span> [<span class="keyword">DESC</span>][默认 <span class="keyword">ASC</span>]], [field2...] [<span class="keyword">ASC</span> [<span class="keyword">DESC</span>][默认 <span class="keyword">ASC</span>]]</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> id <span class="keyword">from</span> <span class="keyword">user</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> username <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>

<h2 id="group-by-分组统计"><a href="#group-by-分组统计" class="headerlink" title="group by 分组统计"></a>group by 分组统计</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> column_name, <span class="keyword">function</span>(column_name)</span><br><span class="line"><span class="keyword">FROM</span> table_name</span><br><span class="line"><span class="keyword">WHERE</span> column_name operator <span class="keyword">value</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> column_name;</span><br><span class="line"></span><br><span class="line">#分组求和，而不是整体求和</span><br><span class="line"><span class="keyword">SELECT</span> Customer,OrderDate,<span class="built_in">SUM</span>(OrderPrice)</span><br><span class="line"><span class="keyword">FROM</span> Orders</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> Customer,OrderDate</span><br></pre></td></tr></table></figure>

<h2 id="group-by-having"><a href="#group-by-having" class="headerlink" title="group by+having"></a>group by+having</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> emp_no, <span class="built_in">count</span>(salary) t     #在工资表里查找员工编号、统计发工资的次数（取别名t）</span><br><span class="line"><span class="keyword">from</span> salaries</span><br><span class="line"><span class="keyword">where</span> creat_date <span class="keyword">between</span> <span class="string">&#x27;2020-01-01&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;2020-12-31&#x27;</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> emp_no        #通过员工编号编组</span><br><span class="line"><span class="keyword">HAVING</span> t<span class="operator">&gt;</span><span class="number">15</span>       #查询发工资次数大于<span class="number">15</span>次的</span><br></pre></td></tr></table></figure>

<h2 id="左连接"><a href="#左连接" class="headerlink" title="左连接"></a>左连接</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> a.bookname, a.pushlishTime, b.usename</span><br><span class="line"><span class="keyword">from</span> Books a</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> Author b</span><br><span class="line"><span class="keyword">on</span> a.uid <span class="operator">=</span> b.id</span><br></pre></td></tr></table></figure>

<h2 id="时间控制"><a href="#时间控制" class="headerlink" title="时间控制"></a>时间控制</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span><span class="operator">/</span>包含当天</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> 表名 <span class="keyword">WHERE</span> DATEDIFF(字段,NOW())<span class="operator">&lt;=</span><span class="number">0</span> <span class="keyword">AND</span> DATEDIFF(字段,NOW())<span class="operator">&gt;</span><span class="operator">-</span>n</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>不包含当天</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> 表名 <span class="keyword">WHERE</span> DATEDIFF(字段,NOW())<span class="operator">&lt;</span><span class="number">0</span> <span class="keyword">AND</span> DATEDIFF(字段,NOW())<span class="operator">&gt;</span><span class="operator">-</span>n</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> a.bookname, a.pushlishTime, b.usename</span><br><span class="line"><span class="keyword">from</span> Books a</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> Author b</span><br><span class="line"><span class="keyword">on</span> a.uid <span class="operator">=</span> b.id</span><br><span class="line"><span class="keyword">where</span> DATEDIFF(a.updateTime, NOW())<span class="operator">&lt;=</span><span class="number">0</span> <span class="keyword">and</span> DATEDIFF(a.updateTime, NOW())<span class="operator">&gt;</span><span class="number">-7</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> a.likes</span><br></pre></td></tr></table></figure>

<h1 id="搜索引擎"><a href="#搜索引擎" class="headerlink" title="搜索引擎"></a>搜索引擎</h1><h2 id="InnoDB："><a href="#InnoDB：" class="headerlink" title="InnoDB："></a>InnoDB：</h2><h3 id="优点：提供良好的事务管理，崩溃修复能力和并发控制，3-层即可控制百万级的数据，聚集索引"><a href="#优点：提供良好的事务管理，崩溃修复能力和并发控制，3-层即可控制百万级的数据，聚集索引" class="headerlink" title="优点：提供良好的事务管理，崩溃修复能力和并发控制，3 层即可控制百万级的数据，聚集索引"></a>优点：提供良好的事务管理，崩溃修复能力和并发控制，3 层即可控制百万级的数据，聚集索引</h3><h3 id="缺点：读写能力较差，占用的数据空间大"><a href="#缺点：读写能力较差，占用的数据空间大" class="headerlink" title="缺点：读写能力较差，占用的数据空间大"></a>缺点：读写能力较差，占用的数据空间大</h3><p><img src="/2022/07/08/mysql//image-20220525235957544.png" alt="image-20220525235957544"></p>
<h2 id="MyISAM："><a href="#MyISAM：" class="headerlink" title="MyISAM："></a>MyISAM：</h2><h3 id="优点：插入速度快，内存占用低，-非聚集索引"><a href="#优点：插入速度快，内存占用低，-非聚集索引" class="headerlink" title="优点：插入速度快，内存占用低， 非聚集索引"></a>优点：插入速度快，内存占用低， 非聚集索引</h3><h3 id="缺点：不支持事务，数据分散存储为三个文件"><a href="#缺点：不支持事务，数据分散存储为三个文件" class="headerlink" title="缺点：不支持事务，数据分散存储为三个文件"></a>缺点：不支持事务，数据分散存储为三个文件</h3><p><img src="/2022/07/08/mysql//image-20220525231552462.png" alt="image-20220525231552462"></p>
<p><img src="/2022/07/08/mysql//image-20220525231604086.png" alt="image-20220525231604086"></p>
<h2 id="Memory"><a href="#Memory" class="headerlink" title="Memory"></a>Memory</h2><h3 id="存取速度快，利用内存中的数据来建立表，安全性比较低。"><a href="#存取速度快，利用内存中的数据来建立表，安全性比较低。" class="headerlink" title="存取速度快，利用内存中的数据来建立表，安全性比较低。"></a>存取速度快，利用内存中的数据来建立表，安全性比较低。</h3><p><img src="/2022/07/08/mysql//image-20220525231623029.png" alt="image-20220525231623029"></p>
<p><img src="/2022/07/08/mysql//image-20220525231630286.png" alt="image-20220525231630286"></p>
<h2 id="索引分类"><a href="#索引分类" class="headerlink" title="索引分类"></a>索引分类</h2><p>主键索引：唯一、非空</p>
<p>唯一索引：唯一、可为空</p>
<p>普通索引：可以重复、为空</p>
<p>全文索引：</p>
<p>组合索引：组合</p>
<h2 id="B-树和-B-树的区别"><a href="#B-树和-B-树的区别" class="headerlink" title="B 树和 B+树的区别"></a>B 树和 B+树的区别</h2><p>B+树只有叶子节点放置数据，而 B 树所有节点都放置数据</p>
<h2 id="回表"><a href="#回表" class="headerlink" title="回表"></a>回表</h2><p>先去非聚集索引的找到 ID，然后聚集索引查询对应的字段。（先非主键索引，然后主键索引）</p>
<h2 id="覆盖索引（建立组合索引来实现）"><a href="#覆盖索引（建立组合索引来实现）" class="headerlink" title="覆盖索引（建立组合索引来实现）"></a>覆盖索引（建立组合索引来实现）</h2><p>使用覆盖索引，MySQL 只需要通过索引就可以查找和返回查询所需要的数据，而不必在使用索引处理数据之后再进行回表操作。</p>
<h2 id="最左匹配原则"><a href="#最左匹配原则" class="headerlink" title="最左匹配原则"></a>最左匹配原则</h2><h1 id="SQL-删除规则"><a href="#SQL-删除规则" class="headerlink" title="SQL 删除规则"></a>SQL 删除规则</h1><p><img src="/2022/07/08/mysql//image-20220526000006280.png" alt="image-20220526000006280"></p>
<h2 id="cascade-级联删除"><a href="#cascade-级联删除" class="headerlink" title="cascade 级联删除"></a>cascade 级联删除</h2><p>解释：（主表被删除，字表的数据也会删除）</p>
<p>父表中删除包含主键值的行的操作，该值由子表的现有行中的外键列引用。</p>
<p>在级联删除中，删除父表中的记录时，同时删除子表中外键引用此主健的记录。</p>
<p>例子：</p>
<p>employee 表中有员工的 dept_id 引用 department 表中 dept_id( 同时为 deptartment 主键 )作为外键。</p>
<p>当 department 表（父表）中一个部门被删除，employee 表（子表）中引用这个部门的 dept_id 作为 dept_id 的记录也自动被删除。</p>
<h2 id="protect"><a href="#protect" class="headerlink" title="protect"></a>protect</h2><p>不让删除，删除会抛出异常。</p>
<h2 id="set-null"><a href="#set-null" class="headerlink" title="set_null"></a>set_null</h2><p>删除的时候，外键置为空值。</p>
<h2 id="set-default"><a href="#set-default" class="headerlink" title="set_default"></a>set_default</h2><p>外键字段置为默认值。</p>
<h2 id="set"><a href="#set" class="headerlink" title="set"></a>set</h2><p>自定义值</p>
<h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><h3 id="1-1-Description"><a href="#1-1-Description" class="headerlink" title="1.1 Description"></a>1.1 Description</h3><p>salary</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">| id | name | sex | salary |</span><br><span class="line">|----|------|-----|--------|</span><br><span class="line">| 1  | A    | m   | 2500   |</span><br><span class="line">| 2  | B    | f   | 1500   |</span><br><span class="line">| 3  | C    | m   | 5500   |</span><br><span class="line">| 4  | D    | f   | 500    |</span><br></pre></td></tr></table></figure>

<p>只用一个 SQL 查询，将 sex 字段反转。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">| id | name | sex | salary |</span><br><span class="line">|----|------|-----|--------|</span><br><span class="line">| 1  | A    | f   | 2500   |</span><br><span class="line">| 2  | B    | m   | 1500   |</span><br><span class="line">| 3  | C    | f   | 5500   |</span><br><span class="line">| 4  | D    | m   | 500    |</span><br></pre></td></tr></table></figure>

<h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>两个相等的数异或的结果为 0，而 0 与任何一个数异或的结果为这个数。</p>
<p>sex  字段只有两个取值：’f’ 和 ‘m’，并且有以下规律：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27;f&#x27; ^ (&#x27;m&#x27; ^ &#x27;f&#x27;) = &#x27;m&#x27; ^ (&#x27;f&#x27; ^ &#x27;f&#x27;) = &#x27;m&#x27;</span><br><span class="line">&#x27;m&#x27; ^ (&#x27;m&#x27; ^ &#x27;f&#x27;) = &#x27;f&#x27; ^ (&#x27;m&#x27; ^ &#x27;m&#x27;) = &#x27;f&#x27;</span><br></pre></td></tr></table></figure>

<p>因此将 sex 字段和 ‘m’ ^ ‘f’ 进行异或操作，最后就能反转 sex 字段。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> salary</span><br><span class="line"><span class="keyword">SET</span> sex <span class="operator">=</span> <span class="type">CHAR</span>(ASCII(sex) <span class="operator">^</span> ASCII(<span class="string">&#x27;m&#x27;</span>) <span class="operator">^</span> ASCII(<span class="string">&#x27;f&#x27;</span>));</span><br></pre></td></tr></table></figure>

<h3 id="1-2-Description"><a href="#1-2-Description" class="headerlink" title="1.2 Description"></a>1.2 Description</h3><p>邮件地址表：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+----+---------+</span><br><span class="line">| Id | Email   |</span><br><span class="line">+----+---------+</span><br><span class="line">| 1  | john@example.com |</span><br><span class="line">| 2  | bob@example.com |</span><br><span class="line">| 3  | john@example.com |</span><br><span class="line">+----+---------+</span><br></pre></td></tr></table></figure>

<p>删除重复的邮件地址：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+----+------------------+</span><br><span class="line">| Id | Email            |</span><br><span class="line">+----+------------------+</span><br><span class="line">| 1  | john@example.com |</span><br><span class="line">| 2  | bob@example.com  |</span><br><span class="line">+----+------------------+</span><br></pre></td></tr></table></figure>

<h3 id="Solution-1"><a href="#Solution-1" class="headerlink" title="Solution"></a>Solution</h3><p>只保留相同 Email 中 Id 最小的那一个，然后删除其它的。</p>
<p>连接查询：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> p1</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    Person p1,</span><br><span class="line">    Person p2</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">    p1.Email <span class="operator">=</span> p2.Email</span><br><span class="line">    <span class="keyword">AND</span> p1.Id <span class="operator">&gt;</span> p2.Id</span><br></pre></td></tr></table></figure>

<h3 id="1-3-Description"><a href="#1-3-Description" class="headerlink" title="1.3 Description"></a>1.3 Description</h3><p>Employee 表：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+----+-------+--------+-----------+</span><br><span class="line">| Id | Name  | Salary | ManagerId |</span><br><span class="line">+----+-------+--------+-----------+</span><br><span class="line">| 1  | Joe   | 70000  | 3         |</span><br><span class="line">| 2  | Henry | 80000  | 4         |</span><br><span class="line">| 3  | Sam   | 60000  | NULL      |</span><br><span class="line">| 4  | Max   | 90000  | NULL      |</span><br><span class="line">+----+-------+--------+-----------+</span><br></pre></td></tr></table></figure>

<p>查找薪资大于其经理薪资的员工信息。</p>
<h3 id="Solution-2"><a href="#Solution-2" class="headerlink" title="Solution"></a>Solution</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    E1.NAME <span class="keyword">AS</span> Employee</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    Employee E1</span><br><span class="line">    <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Employee E2</span><br><span class="line">    <span class="keyword">ON</span> E1.ManagerId <span class="operator">=</span> E2.Id</span><br><span class="line">    <span class="keyword">AND</span> E1.Salary <span class="operator">&gt;</span> E2.Salary;</span><br></pre></td></tr></table></figure>

<h3 id="1-4-Description"><a href="#1-4-Description" class="headerlink" title="1.4 Description"></a>1.4 Description</h3><p>Employee 表：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+----+-------+--------+--------------+</span><br><span class="line">| Id | Name  | Salary | DepartmentId |</span><br><span class="line">+----+-------+--------+--------------+</span><br><span class="line">| 1  | Joe   | 70000  | 1            |</span><br><span class="line">| 2  | Henry | 80000  | 2            |</span><br><span class="line">| 3  | Sam   | 60000  | 2            |</span><br><span class="line">| 4  | Max   | 90000  | 1            |</span><br><span class="line">+----+-------+--------+--------------+</span><br></pre></td></tr></table></figure>

<p>Department 表：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+----+----------+</span><br><span class="line">| Id | Name     |</span><br><span class="line">+----+----------+</span><br><span class="line">| 1  | IT       |</span><br><span class="line">| 2  | Sales    |</span><br><span class="line">+----+----------+</span><br></pre></td></tr></table></figure>

<p>查找一个 Department 中收入最高者的信息：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+------------+----------+--------+</span><br><span class="line">| Department | Employee | Salary |</span><br><span class="line">+------------+----------+--------+</span><br><span class="line">| IT         | Max      | 90000  |</span><br><span class="line">| Sales      | Henry    | 80000  |</span><br><span class="line">+------------+----------+--------+</span><br></pre></td></tr></table></figure>

<h3 id="Solution-3"><a href="#Solution-3" class="headerlink" title="Solution"></a>Solution</h3><p>创建一个临时表，包含了部门员工的最大薪资。可以对部门进行分组，然后使用 MAX() 汇总函数取得最大薪资。</p>
<p>之后使用连接找到一个部门中薪资等于临时表中最大薪资的员工。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    D.NAME Department,</span><br><span class="line">    E.NAME Employee,</span><br><span class="line">    E.Salary</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    Employee E,</span><br><span class="line">    Department D,</span><br><span class="line">    ( <span class="keyword">SELECT</span> DepartmentId, <span class="built_in">MAX</span>( Salary ) Salary </span><br><span class="line">     <span class="keyword">FROM</span> Employee </span><br><span class="line">     <span class="keyword">GROUP</span> <span class="keyword">BY</span> DepartmentId ) M</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">    E.DepartmentId <span class="operator">=</span> D.Id</span><br><span class="line">    <span class="keyword">AND</span> E.DepartmentId <span class="operator">=</span> M.DepartmentId</span><br><span class="line">    <span class="keyword">AND</span> E.Salary <span class="operator">=</span> M.Salary;</span><br></pre></td></tr></table></figure>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sql/" rel="tag">sql</a></li></ul>

    </footer>
  </div>

   
    
</article>

    
    <article
  id="post-clash"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/07/06/clash/"
    >clash给手机分享热点</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/07/06/clash/" class="article-date">
  <time datetime="2022-07-06T01:56:05.000Z" itemprop="datePublished">2022-07-06</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>电脑clash端如下配置，手机和电脑连接<strong>同一个wifi</strong>，<strong>点开</strong>clash <strong>Allow LAN</strong>的时候会有<strong>WLAN</strong>地址，就是代理地址，需要在手机上配置，例如：现在是代理地址192.168.0.10，clash <strong>Port端口</strong>为8888</p>
<p><img src="/2022/07/06/clash//image-20220706094825205.png" alt="image-20220706094825205"></p>
<p><img src="/2022/07/06/clash//image-20220706095105820.png" alt="image-20220706095105820"></p>
<p>手机上配置如下：</p>
<p><img src="/2022/07/06/clash//image-20220706095224196.png" alt="image-20220706095224196"></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%88%B7%E6%9C%BA/" rel="tag">刷机</a></li></ul>

    </footer>
  </div>

   
    
</article>

    
    <article
  id="post-刷机"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/07/06/%E5%88%B7%E6%9C%BA/"
    >1+9r刷机笔记</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/07/06/%E5%88%B7%E6%9C%BA/" class="article-date">
  <time datetime="2022-07-06T01:56:05.000Z" itemprop="datePublished">2022-07-06</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="准备工作，color-os线刷至氧os"><a href="#准备工作，color-os线刷至氧os" class="headerlink" title="准备工作，color os线刷至氧os"></a>准备工作，color os线刷至氧os</h2><p>教程<br><a target="_blank" rel="noopener" href="https://www.hkepc.com/forum/viewthread.php?fid=168&amp;tid=2620340&amp;page=1">https://www.hkepc.com/forum/viewthread.php?fid=168&amp;tid=2620340&amp;page=1</a></p>
<h2 id="1、解锁-bootloader教程"><a href="#1、解锁-bootloader教程" class="headerlink" title="1、解锁 bootloader教程"></a>1、解锁 bootloader教程</h2><h3 id="1-1-驱动安装（Google-USB、高通驱动）"><a href="#1-1-驱动安装（Google-USB、高通驱动）" class="headerlink" title="1.1 驱动安装（Google USB、高通驱动）"></a>1.1 驱动安装（Google USB、高通驱动）</h3><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1n64y1u7LE?p=1&amp;share_medium=android_i&amp;share_plat=android&amp;share_source=COPY&amp;share_tag=s_i&amp;timestamp=1644025451&amp;unique_k=Tc4bIVY">https://www.bilibili.com/video/BV1n64y1u7LE?p=1&amp;share_medium=android_i&amp;share_plat=android&amp;share_source=COPY&amp;share_tag=s_i&amp;timestamp=1644025451&amp;unique_k=Tc4bIVY</a></p>
<h3 id="1-2-adb命令解锁bootloader"><a href="#1-2-adb命令解锁bootloader" class="headerlink" title="1.2 adb命令解锁bootloader"></a>1.2 adb命令解锁bootloader</h3><p>fastboot devices</p>
<p>fastboot oem unlock</p>
<h2 id="2、刷入第三方-twrp"><a href="#2、刷入第三方-twrp" class="headerlink" title="2、刷入第三方 twrp"></a>2、刷入第三方 twrp</h2><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/av841014036?from=search&seid=13682037280247844152">参考链接</a></p>
<p>首先下载recover.img<br>然后进入bootloader模式，命令行输入,即可刷入，然后进入引导模式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fastboot flash recovery recovery.img</span><br><span class="line"></span><br><span class="line">fastboot boot recovery.img</span><br></pre></td></tr></table></figure>

<h2 id="3、清除系统数据"><a href="#3、清除系统数据" class="headerlink" title="3、清除系统数据"></a>3、清除系统数据</h2><p><a target="_blank" rel="noopener" href="https://unofficialtwrp.com/twrp-3-5-1-root-oneplus-9r/#How_to_Install_twrp_Recovery_on_OnePlus_9R">参考链接</a></p>
<h3 id="若有问题，刷入以下命令"><a href="#若有问题，刷入以下命令" class="headerlink" title="若有问题，刷入以下命令"></a>若有问题，刷入以下命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fastboot flash recovery_a twrp.img</span><br><span class="line"></span><br><span class="line">fastboot flash recovery_b twrp.img</span><br></pre></td></tr></table></figure>

<p>清除a&#x2F;b分区</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fastboot flash vbmeta vbmeta.img</span><br><span class="line">fastboot format userdata</span><br></pre></td></tr></table></figure>

<h2 id="4、清空文件，twrp情况下，进入recovery模式，进行zip文件传输，命令如下，-zip为具体的zip名称"><a href="#4、清空文件，twrp情况下，进入recovery模式，进行zip文件传输，命令如下，-zip为具体的zip名称" class="headerlink" title="4、清空文件，twrp情况下，进入recovery模式，进行zip文件传输，命令如下，*zip为具体的zip名称"></a>4、清空文件，twrp情况下，进入recovery模式，进行zip文件传输，命令如下，*zip为具体的zip名称</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">adb devices</span><br><span class="line"></span><br><span class="line">adb push *.zip /sdcard</span><br></pre></td></tr></table></figure>

<h2 id="5、install-选择zip文件安装"><a href="#5、install-选择zip文件安装" class="headerlink" title="5、install 选择zip文件安装"></a>5、install 选择zip文件安装</h2><h2 id="other-way-可以通过adb命令的方式来刷入文件"><a href="#other-way-可以通过adb命令的方式来刷入文件" class="headerlink" title="other way 可以通过adb命令的方式来刷入文件"></a>other way 可以通过adb命令的方式来刷入文件</h2><p><a target="_blank" rel="noopener" href="https://www.oneplusbbs.com/thread-4796616-1.html">https://www.oneplusbbs.com/thread-4796616-1.html</a></p>
<h1 id="刷机方式2"><a href="#刷机方式2" class="headerlink" title="刷机方式2"></a>刷机方式2</h1><h2 id="一键刷机步骤，只需要rom包即可"><a href="#一键刷机步骤，只需要rom包即可" class="headerlink" title="一键刷机步骤，只需要rom包即可"></a>一键刷机步骤，只需要rom包即可</h2><ul>
<li>前提，先解锁，安装好高通驱动和google usb驱动，驱动直接安装即可</li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/melons99/p/16307830.html">参考链接</a></li>
<li>首先准备ROM包，提取里面的的文件</li>
<li>使用一键刷机工具刷机即可</li>
</ul>
<h2 id="救砖方式，线刷至氧os即可，关机后，上下键按住，进入9008模式。"><a href="#救砖方式，线刷至氧os即可，关机后，上下键按住，进入9008模式。" class="headerlink" title="救砖方式，线刷至氧os即可，关机后，上下键按住，进入9008模式。"></a>救砖方式，线刷至氧os即可，关机后，上下键按住，进入9008模式。</h2><h1 id="root权限获取"><a href="#root权限获取" class="headerlink" title="root权限获取"></a>root权限获取</h1><h2 id="首先将安装包提取boot-img"><a href="#首先将安装包提取boot-img" class="headerlink" title="首先将安装包提取boot.img"></a>首先将安装包提取boot.img</h2><p><a target="_blank" rel="noopener" href="https://www.daxiaamu.com/5804/">参考链接</a><br><a target="_blank" rel="noopener" href="https://yun.daxiaamu.com/files/tool/payload.bin%E8%A7%A3%E5%8C%85%E5%B7%A5%E5%85%B7/payload%20dumper_go_%E5%A4%A7%E4%BE%A0%E9%98%BF%E6%9C%A8%E9%87%8D%E5%88%B6/%E6%8A%8AROM%E6%8B%96%E5%88%B0%E6%88%91%E5%A4%B4%E4%B8%8A.exe?preview">参考链接</a></p>
<h2 id="利用magisk将boot-img修改为patched-boot-img"><a href="#利用magisk将boot-img修改为patched-boot-img" class="headerlink" title="利用magisk将boot.img修改为patched_boot.img"></a>利用magisk将boot.img修改为patched_boot.img</h2><h2 id="刷入修改后的patched-boot-img"><a href="#刷入修改后的patched-boot-img" class="headerlink" title="刷入修改后的patched_boot.img"></a>刷入修改后的patched_boot.img</h2><p>fastboot flash boot magisk_patched.img</p>
<h2 id="救砖教程参考链接"><a href="#救砖教程参考链接" class="headerlink" title="救砖教程参考链接"></a>救砖教程参考链接</h2><p><a target="_blank" rel="noopener" href="https://www.oneplusbbs.com/forum.php?mod=viewthread&amp;tid=4988971">https://www.oneplusbbs.com/forum.php?mod=viewthread&amp;tid=4988971</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_39771775/article/details/111112651">https://blog.csdn.net/weixin_39771775/article/details/111112651</a></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%88%B7%E6%9C%BA/" rel="tag">刷机</a></li></ul>

    </footer>
  </div>

   
    
</article>

    
    <article
  id="post-Python装饰器"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/05/30/Python%E8%A3%85%E9%A5%B0%E5%99%A8/"
    >Python装饰器</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/05/30/Python%E8%A3%85%E9%A5%B0%E5%99%A8/" class="article-date">
  <time datetime="2022-05-29T16:09:10.000Z" itemprop="datePublished">2022-05-30</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="property"><a href="#property" class="headerlink" title="@property"></a>@property</h2><p>将方法变成属性使用</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">birth</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self._birth</span><br><span class="line"></span><br><span class="line"><span class="meta">    @birth.setter</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">birth</span>(<span class="params">self, value</span>):</span><br><span class="line">        self._birth = value</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">age</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2015</span> - self._birth</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s = Student()</span><br><span class="line">s.birth = <span class="number">1998</span>  <span class="comment"># set_birth</span></span><br><span class="line"><span class="built_in">print</span>(s.birth)  <span class="comment"># get_birth</span></span><br><span class="line"><span class="built_in">print</span>(s.age)</span><br></pre></td></tr></table></figure>

<h2 id="classmethod"><a href="#classmethod" class="headerlink" title="@classmethod"></a>@classmethod</h2><p>classmethod: 无序实例化即可使用，class.func()</p>
<p>普通：实例化才可使用，A&#x3D;class(), A.func()</p>
<p>带修饰类方法：<strong>cls</strong>做为方法的<strong>第一个参数</strong>，隐式的将类做为对象，传递给方法，调用时<strong>无须实例化</strong>。</p>
<p>普通函数方法：self做为第一个参数，隐式的将类实例传递给方法，调用方法时，类必须实例化。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">self, x, y</span>):</span><br><span class="line">        <span class="keyword">return</span> x * y</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">cfunc</span>(<span class="params">cls, x, y</span>):</span><br><span class="line">        <span class="keyword">return</span> x * y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(A().func(<span class="number">5</span>, <span class="number">5</span>))</span><br><span class="line">    <span class="built_in">print</span>(A.cfunc(<span class="number">4</span>, <span class="number">5</span>))</span><br></pre></td></tr></table></figure>

<h2 id="static"><a href="#static" class="headerlink" title="@static"></a>@static</h2><p>仅需要功能，而不需要类的时候使用。不用实例化就可以调用。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># staticmethod</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">cal</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">x, y</span>):</span><br><span class="line">        <span class="keyword">return</span> x+y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(cal.add(<span class="number">3</span>, <span class="number">4</span>))</span><br></pre></td></tr></table></figure>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python%E8%A3%85%E9%A5%B0%E5%99%A8/" rel="tag">Python装饰器</a></li></ul>

    </footer>
  </div>

   
    
</article>

    
    <article
  id="post-choices"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/05/30/choices/"
    >choices</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/05/30/choices/" class="article-date">
  <time datetime="2022-05-29T16:09:10.000Z" itemprop="datePublished">2022-05-30</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/django/">django</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">gender_choice = [</span><br><span class="line">     (<span class="number">1</span>, <span class="string">&#x27;男&#x27;</span>),</span><br><span class="line">     (<span class="number">2</span>, <span class="string">&#x27;女&#x27;</span>),</span><br><span class="line"> ]</span><br><span class="line"></span><br><span class="line"> gender = models.SmallIntegerField(verbose_name=<span class="string">&#x27;性别&#x27;</span>, choices=gender_choice)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="字段用法"><a href="#字段用法" class="headerlink" title="字段用法"></a>字段用法</h2><p>元组第一个数据的是用来存储在数据库中，第二个数据是用来显示的，取出显示字段的函数为</p>
<p>get_xxx_display。</p>
<p>若没有对应的元组，则按存储字段来显示。</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/choices/" rel="tag">choices</a></li></ul>

    </footer>
  </div>

   
    
</article>

    
    <article
  id="post-cookies和session的使用"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/05/30/cookies%E5%92%8Csession%E7%9A%84%E4%BD%BF%E7%94%A8/"
    >cookies和session的使用</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/05/30/cookies%E5%92%8Csession%E7%9A%84%E4%BD%BF%E7%94%A8/" class="article-date">
  <time datetime="2022-05-29T16:09:10.000Z" itemprop="datePublished">2022-05-30</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/django/">django</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h1><h2 id="cookie的设置"><a href="#cookie的设置" class="headerlink" title="cookie的设置"></a>cookie的设置</h2><p><img src="/2022/05/30/cookies%E5%92%8Csession%E7%9A%84%E4%BD%BF%E7%94%A8//1636380721512.png"></p>
<h2 id="cookie的获取和删除"><a href="#cookie的获取和删除" class="headerlink" title="cookie的获取和删除"></a>cookie的获取和删除</h2><p><img src="/2022/05/30/cookies%E5%92%8Csession%E7%9A%84%E4%BD%BF%E7%94%A8//1636380640224.png" alt="img"></p>
<h1 id="Session"><a href="#Session" class="headerlink" title="Session"></a>Session</h1><h2 id="session开启的初始配置"><a href="#session开启的初始配置" class="headerlink" title="session开启的初始配置"></a>session开启的初始配置</h2><p><img src="/2022/05/30/cookies%E5%92%8Csession%E7%9A%84%E4%BD%BF%E7%94%A8//1636381889990.png"><img src="/2022/05/30/cookies%E5%92%8Csession%E7%9A%84%E4%BD%BF%E7%94%A8//1636382085181.png"></p>
<p><img src="/2022/05/30/cookies%E5%92%8Csession%E7%9A%84%E4%BD%BF%E7%94%A8//1636382413875.png"></p>
<p><img src="/2022/05/30/cookies%E5%92%8Csession%E7%9A%84%E4%BD%BF%E7%94%A8//1636424092444.png"></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cookies/" rel="tag">cookies</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/session/" rel="tag">session</a></li></ul>

    </footer>
  </div>

   
    
</article>

    
    <article
  id="post-redis"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/05/30/redis/"
    >redis</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/05/30/redis/" class="article-date">
  <time datetime="2022-05-29T16:09:10.000Z" itemprop="datePublished">2022-05-30</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="安装redis"><a href="#安装redis" class="headerlink" title="安装redis"></a>安装redis</h1><p><img src="/2022/05/30/redis//1644755852532.png" alt="img"></p>
<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><h3 id="备份conf文件，并修改权限为redis用户和redis用户组"><a href="#备份conf文件，并修改权限为redis用户和redis用户组" class="headerlink" title="备份conf文件，并修改权限为redis用户和redis用户组"></a>备份conf文件，并修改权限为redis用户和redis用户组</h3><p><img src="/2022/05/30/redis//1644756290543.png"></p>
<h3 id="conf文件第500行，去掉注释，添加密码"><a href="#conf文件第500行，去掉注释，添加密码" class="headerlink" title="conf文件第500行，去掉注释，添加密码"></a>conf文件第500行，去掉注释，添加密码</h3><p><img src="/2022/05/30/redis//1644757538697.png" alt="img"></p>
<p>通过密码连接redis后，输入ping验证返回pong才为连接成功！</p>
<p><img src="/2022/05/30/redis//1644757884539.png" alt="img"></p>
<p><img src="/2022/05/30/redis//1644757984964.png" alt="img"></p>
<h2 id="远程连接"><a href="#远程连接" class="headerlink" title="远程连接"></a>远程连接</h2><h2 id="redis命令："><a href="#redis命令：" class="headerlink" title="redis命令："></a>redis命令：</h2><p><img src="/2022/05/30/redis//1644812992612.png" alt="img"></p>
<p><img src="/2022/05/30/redis//1644813042338.png"></p>
<p><img src="/2022/05/30/redis//1644813124017.png"></p>
<p><img src="/2022/05/30/redis//1644813183997.png"></p>
<h1 id="字符串1"><a href="#字符串1" class="headerlink" title="字符串1"></a>字符串1</h1><p><img src="/2022/05/30/redis//1644813353215.png"></p>
<h2 id="设置参数"><a href="#设置参数" class="headerlink" title="设置参数"></a>设置参数</h2><p><img src="/2022/05/30/redis//1644813660462.png" alt="img"></p>
<h2 id="获取key"><a href="#获取key" class="headerlink" title="获取key"></a>获取key</h2><p><img src="/2022/05/30/redis//1644819831236.png" alt="img"></p>
<p><img src="/2022/05/30/redis//1644819822754.png"></p>
<h2 id="批量操作"><a href="#批量操作" class="headerlink" title="批量操作"></a>批量操作</h2><p><img src="/2022/05/30/redis//1644820728709.png"></p>
<p><img src="/2022/05/30/redis//1644820733978.png"></p>
<h2 id="数值操作"><a href="#数值操作" class="headerlink" title="数值操作"></a>数值操作</h2><p>incrby默认key为0</p>
<p><img src="/2022/05/30/redis//1644999905406.png" alt="img"></p>
<h2 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h2><p><img src="/2022/05/30/redis//1645000061220.png"></p>
<h2 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h2><p><img src="/2022/05/30/redis//1645000389374.png"></p>
<p>1、keys *</p>
<p>2、set trill:username user001, get trill:username</p>
<p>3、strlen trill:username</p>
<p>4、mset trill:username xx</p>
<p>5、exists trill:username</p>
<p>6、incrby fans 10</p>
<p>7、incr fans 2次</p>
<p>8、decrby fans 3</p>
<p>9、decr fans 1次</p>
<p>10、flushdb</p>
<p>11、flushall</p>
<h1 id="字符串2"><a href="#字符串2" class="headerlink" title="字符串2"></a>字符串2</h1><p>ex命令只有在字符串中才存在，若想其他key也支持，需要手动指定</p>
<p><img src="/2022/05/30/redis//1645002714084.png"></p>
<h2 id="ttl-key（检查过期时间，-persist-key过期变为不过期）"><a href="#ttl-key（检查过期时间，-persist-key过期变为不过期）" class="headerlink" title="ttl key（检查过期时间， persist key过期变为不过期）"></a>ttl key（检查过期时间， persist key过期变为不过期）</h2><p><img src="/2022/05/30/redis//1645002896436.png"></p>
<h2 id="惰性删除（不是等到key过期就直接删除，而是请求key的时候判断是否过期）"><a href="#惰性删除（不是等到key过期就直接删除，而是请求key的时候判断是否过期）" class="headerlink" title="惰性删除（不是等到key过期就直接删除，而是请求key的时候判断是否过期）"></a>惰性删除（不是等到key过期就直接删除，而是请求key的时候判断是否过期）</h2><p><img src="/2022/05/30/redis//1645015457811.png"></p>
<h2 id="定期删除，随机采样删除数据库中的数据"><a href="#定期删除，随机采样删除数据库中的数据" class="headerlink" title="定期删除，随机采样删除数据库中的数据"></a>定期删除，随机采样删除数据库中的数据</h2><p><img src="/2022/05/30/redis//1645016084355.png"></p>
<p><img src="/2022/05/30/redis//1645015924165.png"></p>
<h2 id="主动删除机制（默认为no-enviction机制，不让继续写入，但是可以删除key）"><a href="#主动删除机制（默认为no-enviction机制，不让继续写入，但是可以删除key）" class="headerlink" title="主动删除机制（默认为no-enviction机制，不让继续写入，但是可以删除key）"></a>主动删除机制（默认为no-enviction机制，不让继续写入，但是可以删除key）</h2><p><img src="/2022/05/30/redis//1645016832585.png"></p>
<h1 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h1><h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><p><img src="/2022/05/30/redis//1645017622788.png"></p>
<p><img src="/2022/05/30/redis//1645018488072.png"></p>
<p><img src="/2022/05/30/redis//1645017694612.png" alt="img"></p>
<p><img src="/2022/05/30/redis//1645020756449.png"></p>
<p><img src="/2022/05/30/redis//1645020952979.png"></p>
<p><img src="/2022/05/30/redis//1645021160696.png"></p>
<p><img src="/2022/05/30/redis//1645021252577.png"></p>
<p><img src="/2022/05/30/redis//1645022325024.png"></p>
<h2 id="练习-1"><a href="#练习-1" class="headerlink" title="练习"></a>练习</h2><p><img src="/2022/05/30/redis//1645024743629.png" alt="img"></p>
<p>1、keys *</p>
<p>2、RPUSH spider 1 2</p>
<p>3、lrange spider 0 -1</p>
<p>4、llen spider</p>
<p>5、lset spider 0 01</p>
<p>6、linsert spider after 04 02</p>
<p>7、rpop spider</p>
<p>8、lrem spider 0 02</p>
<p>9、ltrim spider 0 2</p>
<h1 id="pyredis操作"><a href="#pyredis操作" class="headerlink" title="pyredis操作"></a>pyredis操作</h1><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p><img src="/2022/05/30/redis//1645161722169.png"></p>
<h2 id="代码中使用方法"><a href="#代码中使用方法" class="headerlink" title="代码中使用方法"></a>代码中使用方法</h2><p><img src="/2022/05/30/redis//1645161776289.png"></p>
<h1 id="位图"><a href="#位图" class="headerlink" title="位图"></a>位图</h1><p><img src="/2022/05/30/redis//1645171869946.png" alt="img"></p>
<p><img src="/2022/05/30/redis//1645171935518.png"></p>
<h2 id="常用命令-1"><a href="#常用命令-1" class="headerlink" title="常用命令"></a>常用命令</h2><p>setbit，key不存在时，全部默认初始化为0，长度为 8 的倍数。</p>
<p> <img src="/2022/05/30/redis//1645172436427.png"></p>
<p><img src="/2022/05/30/redis//1645172595105.png"></p>
<h2 id="字节索引，-8位为一个字节，前8位为0，接着8为为1，以此类推"><a href="#字节索引，-8位为一个字节，前8位为0，接着8为为1，以此类推" class="headerlink" title="字节索引， 8位为一个字节，前8位为0，接着8为为1，以此类推"></a>字节索引， 8位为一个字节，前8位为0，接着8为为1，以此类推</h2><p><img src="/2022/05/30/redis//1645172650634.png"></p>
<p><img src="/2022/05/30/redis//1645172868091.png"></p>
<p><img src="/2022/05/30/redis//1645172895802.png"></p>
<p><img src="/2022/05/30/redis//1645172968966.png"></p>
<h1 id="哈希"><a href="#哈希" class="headerlink" title="哈希"></a>哈希</h1><p><img src="/2022/05/30/redis//1645189817987.png"></p>
<h2 id="特点条件下，比如用户有姓名、身份证号，电话号码啥的多个信息，可以使用hash，更加节约内存，同时也比查找多个字符串更加快速的获取字段值。"><a href="#特点条件下，比如用户有姓名、身份证号，电话号码啥的多个信息，可以使用hash，更加节约内存，同时也比查找多个字符串更加快速的获取字段值。" class="headerlink" title="特点条件下，比如用户有姓名、身份证号，电话号码啥的多个信息，可以使用hash，更加节约内存，同时也比查找多个字符串更加快速的获取字段值。"></a>特点条件下，比如用户有姓名、身份证号，电话号码啥的多个信息，可以使用hash，更加节约内存，同时也比查找多个字符串更加快速的获取字段值。</h2><p>缺点是过期只能将所有的保存信息进行过期操作，而不能对单个信息进行过期操作。+</p>
<p><img src="/2022/05/30/redis//1645241753956.png" alt="img"></p>
<h2 id="常用命令-2"><a href="#常用命令-2" class="headerlink" title="常用命令"></a>常用命令</h2><p><img src="/2022/05/30/redis//1645242100281.png"></p>
<p><img src="/2022/05/30/redis//1645242121991.png"></p>
<p><img src="/2022/05/30/redis//1645242396590.png"></p>
<p><img src="/2022/05/30/redis//1645242261452.png" alt="img"></p>
<h2 id="应用场景-1"><a href="#应用场景-1" class="headerlink" title="应用场景"></a>应用场景</h2><p><img src="/2022/05/30/redis//1645242547812.png"></p>
<p><img src="/2022/05/30/redis//1645242586733.png"></p>
<h2 id="Python中hash算法处理过程"><a href="#Python中hash算法处理过程" class="headerlink" title="Python中hash算法处理过程"></a>Python中hash算法处理过程</h2><p><img src="/2022/05/30/redis//1645275342085.png"></p>
<h2 id="redis中hash算法处理流程"><a href="#redis中hash算法处理流程" class="headerlink" title="redis中hash算法处理流程"></a>redis中hash算法处理流程</h2><p>位置重复时，采用多重链表来解决</p>
<p><img src="/2022/05/30/redis//1645275652961.png"></p>
<h1 id="集合（无序，去重）"><a href="#集合（无序，去重）" class="headerlink" title="集合（无序，去重）"></a>集合（无序，去重）</h1><h2 id="常用命令-3"><a href="#常用命令-3" class="headerlink" title="常用命令"></a>常用命令</h2><p><img src="/2022/05/30/redis//1645275970650.png"></p>
<p><img src="/2022/05/30/redis//1645276039575.png"></p>
<p>8、将元素从一个集合转移到另一个集合</p>
<p>9、差集依照左边为标准</p>
<p><img src="/2022/05/30/redis//1645276712258.png" alt="img">‘<img src="/2022/05/30/redis//1645276849544.png"></p>
<h2 id="应用场景-2"><a href="#应用场景-2" class="headerlink" title="应用场景"></a>应用场景</h2><p><img src="/2022/05/30/redis//1645276951590.png"></p>
<h2 id="底层实现（A、纯数字-intset-B、有字符串-hashtable）"><a href="#底层实现（A、纯数字-intset-B、有字符串-hashtable）" class="headerlink" title="底层实现（A、纯数字 intset  B、有字符串 hashtable）"></a>底层实现（A、纯数字 intset  B、有字符串 hashtable）</h2><p><img src="/2022/05/30/redis//1645277321431.png"></p>
<h1 id="有序集合"><a href="#有序集合" class="headerlink" title="有序集合"></a>有序集合</h1><p><img src="/2022/05/30/redis//1645278974341.png"></p>
<h2 id="常用命令-4"><a href="#常用命令-4" class="headerlink" title="常用命令"></a>常用命令</h2><p><img src="/2022/05/30/redis//1645279080388.png"></p>
<p><img src="/2022/05/30/redis//1645280110323.png"></p>
<p><img src="/2022/05/30/redis//1645280515092.png"></p>
<p><img src="/2022/05/30/redis//1645280594502.png"></p>
<p>weight操作时，先根据权重转换集合对应的值，然后在进行聚合运算</p>
<p><img src="/2022/05/30/redis//1645281523322.png"></p>
<h2 id="应用场景-3"><a href="#应用场景-3" class="headerlink" title="应用场景"></a>应用场景</h2><p><img src="/2022/05/30/redis//1645282127518.png" alt="img"></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/redis/" rel="tag">redis</a></li></ul>

    </footer>
  </div>

   
    
</article>

    
    <article
  id="post-restframework"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/05/30/restframework/"
    >rest_framework</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/05/30/restframework/" class="article-date">
  <time datetime="2022-05-29T16:09:10.000Z" itemprop="datePublished">2022-05-30</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/django/">django</a> / <a class="article-category-link" href="/categories/django/rest-framework/">rest_framework</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="RestFrameWork"><a href="#RestFrameWork" class="headerlink" title="RestFrameWork"></a>RestFrameWork</h1><h2 id="流程图"><a href="#流程图" class="headerlink" title="流程图"></a>流程图</h2><p><img src="/2022/05/30/restframework//1648878943995.png" alt="img"></p>
<h2 id="认证"><a href="#认证" class="headerlink" title="认证"></a>认证</h2><ol>
<li><p>问题：有些API需要用户登陆成功后才可以访问，有些无需登录便可访问</p>
</li>
<li><p>解决方案</p>
<ul>
<li>创建两张表（user， token)</li>
<li>用户登录（返回token并保存到数据库）</li>
</ul>
</li>
<li><p>认证流程图，如图</p>
</li>
<li><p>使用方法</p>
<ul>
<li>局部使用 &amp; 全局使用</li>
<li>匿名的时候，request.user、auth 为 None</li>
</ul>
</li>
<li><p>内置认证类</p>
<ul>
<li>认证类，必须继承于：from rest_framework.authentication import BaseAuthentication</li>
<li>其他认证类：BasicAuthentication，SessionAuthentication</li>
</ul>
</li>
</ol>
<h3 id="认证流程"><a href="#认证流程" class="headerlink" title="认证流程"></a>认证流程</h3><ul>
<li><p>创建类，继承 BaseAuthentication，实现 authenticate 方法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Authication</span>(<span class="title class_ inherited__">BaseAuthentication</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">authenticate</span>(<span class="params">self, request</span>):</span><br><span class="line">        token = request._request.GET.get(<span class="string">&#x27;token&#x27;</span>)</span><br><span class="line">        token_obj = models.UserToken.objects.<span class="built_in">filter</span>(token=token).first()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> token_obj:</span><br><span class="line">            <span class="keyword">raise</span> AuthenticationFailed(<span class="string">&#x27;用户认证失败!&#x27;</span>)</span><br><span class="line">        <span class="comment"># rest_framework 内部会将两个字段赋给 request, 以便后续使用</span></span><br><span class="line">        <span class="comment"># 分别为 self.user, self.auth</span></span><br><span class="line">        <span class="keyword">return</span> (token_obj.user, token_obj)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">authenticate_header</span>(<span class="params">self, request</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>返回值：</p>
<ul>
<li>None</li>
<li>raise excetion</li>
</ul>
</li>
<li><p>局部使用</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">OrderView</span>(<span class="title class_ inherited__">APIView</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    订单相关业务</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    authentication_classes = [Authication, ]</span><br><span class="line"></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="number">1</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>: <span class="string">&#x27;zhangsan&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;pwd&#x27;</span>: <span class="number">123</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="number">2</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>: <span class="string">&#x27;lisi&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;pwd&#x27;</span>: <span class="number">123</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get</span>(<span class="params">self, request, *args, **kwargs</span>):</span><br><span class="line">        ret = &#123;<span class="string">&#x27;code&#x27;</span>: <span class="number">1000</span>, <span class="string">&#x27;msg&#x27;</span>: <span class="literal">None</span>, <span class="string">&#x27;data&#x27;</span>: <span class="literal">None</span>&#125;</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            ret[<span class="string">&#x27;data&#x27;</span>] = self.data</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> JsonResponse(ret)</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>全局使用 setting.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">REST_FRAMEWORK = &#123;</span><br><span class="line">    <span class="comment"># 全局认证，若某个类不需要，可以设置authentication_classes为[]</span></span><br><span class="line">    <span class="string">&#x27;DEFAULT_AUTHENTICATION_CLASSES&#x27;</span>: [<span class="string">&#x27;api.auth.Authentication.FirstAuthication&#x27;</span>,</span><br><span class="line">                                       <span class="string">&#x27;api.auth.Authentication.Authication&#x27;</span>],</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;UNAUTHENTICATED_USER&#x27;</span>: <span class="literal">None</span>,  <span class="comment"># 匿名，request.user = None</span></span><br><span class="line">    <span class="string">&#x27;UNAUTHENTICATED_TOKEN&#x27;</span>: <span class="literal">None</span>,  <span class="comment"># 匿名 request.auth = None</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="源码流程"><a href="#源码流程" class="headerlink" title="源码流程"></a>源码流程</h3><p>dispatch -&gt; 封装request -&gt; request.user -&gt; authentication_classes -&gt; authentication_classes</p>
<h2 id="权限"><a href="#权限" class="headerlink" title="权限"></a>权限</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyPermission</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">has_permission</span>(<span class="params">self, request, view</span>):</span><br><span class="line">        <span class="keyword">if</span> request.user.user_type != <span class="number">3</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure>

<h3 id="全局设置"><a href="#全局设置" class="headerlink" title="全局设置"></a>全局设置</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">REST_FRAMEWORK = &#123;</span><br><span class="line">    <span class="comment"># 全局认证，若某个类不需要，可以设置authentication_classes为[]</span></span><br><span class="line">    <span class="string">&#x27;DEFAULT_AUTHENTICATION_CLASSES&#x27;</span>: [<span class="string">&#x27;api.auth.Authentication.FirstAuthication&#x27;</span>,</span><br><span class="line">                                       <span class="string">&#x27;api.auth.Authentication.Authication&#x27;</span>],</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;UNAUTHENTICATED_USER&#x27;</span>: <span class="literal">None</span>,  <span class="comment"># 匿名，request.user = None</span></span><br><span class="line">    <span class="string">&#x27;UNAUTHENTICATED_TOKEN&#x27;</span>: <span class="literal">None</span>,  <span class="comment"># 匿名 request.auth = None</span></span><br><span class="line">    <span class="string">&quot;DEFAULT_PERMISSION_CLASSES&quot;</span>: [<span class="string">&#x27;api.auth.permission.MyPermission&#x27;</span>, ],  <span class="comment"># permission</span></span><br><span class="line">    <span class="string">&#x27;DEFAULT_THROTTLE_CLASSES&#x27;</span>: [<span class="string">&#x27;api.auth.throttle.VisitThrottle&#x27;</span>],  <span class="comment"># 频率</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="频率"><a href="#频率" class="headerlink" title="频率"></a>频率</h2><ul>
<li>类，继承于：BaseThrottle，实现 allow_request、wait函数</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">VisitThrottle</span>(<span class="title class_ inherited__">BaseThrottle</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    60S内只能访问3次</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.history = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">allow_request</span>(<span class="params">self, request, view</span>):</span><br><span class="line">        ip = request.META.get(<span class="string">&#x27;REMOTE_ADDR&#x27;</span>)</span><br><span class="line">        ctime = time.time()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ip <span class="keyword">not</span> <span class="keyword">in</span> VISIT_RECORD:</span><br><span class="line">            <span class="comment"># 将第一次访问的时间加入</span></span><br><span class="line">            VISIT_RECORD[ip] = [ctime, ]</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        history = VISIT_RECORD.get(ip)</span><br><span class="line">        self.history = history</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> history <span class="keyword">and</span> history[-<span class="number">1</span>] &lt; ctime - <span class="number">60</span>:</span><br><span class="line">            <span class="comment"># 判断history是否有值，且最后一个值的时间是否小于60s，小于则可以移除</span></span><br><span class="line">            history.pop()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(history) &lt; <span class="number">3</span>:</span><br><span class="line">            VISIT_RECORD[ip].insert(<span class="number">0</span>, ctime)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">wait</span>(<span class="params">self</span>):</span><br><span class="line">        ctime = time.time()</span><br><span class="line">        <span class="keyword">return</span> <span class="number">60</span> - (ctime - self.history[-<span class="number">1</span>])</span><br></pre></td></tr></table></figure>

<ul>
<li>类，继承于: SimpleRateThrottle，实现get_cache_key函数，并且修改setting配置</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">IpThrottle</span>(<span class="title class_ inherited__">SimpleRateThrottle</span>):</span><br><span class="line">scope = <span class="string">&#x27;ip&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_cache_key</span>(<span class="params">self, request, view</span>):</span><br><span class="line">    <span class="comment"># 通过ip来控制访问频率</span></span><br><span class="line">    <span class="keyword">return</span> self.get_ident(request)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserThrottle</span>(<span class="title class_ inherited__">SimpleRateThrottle</span>):</span><br><span class="line">scope = <span class="string">&#x27;user&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_cache_key</span>(<span class="params">self, request, view</span>):</span><br><span class="line">    <span class="comment"># 用户名</span></span><br><span class="line">    <span class="keyword">return</span> request.user.username</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;DEFAULT_THROTTLE_RATES&#x27;</span>: &#123;</span><br><span class="line">    <span class="string">&#x27;ip&#x27;</span>: <span class="string">&#x27;3/m&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;user&#x27;</span>: <span class="string">&#x27;5/m&#x27;</span>,</span><br><span class="line">&#125;,</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="重要程度"><a href="#重要程度" class="headerlink" title="重要程度"></a>重要程度</h1><ul>
<li>版本        *</li>
<li>解析器     *</li>
<li>序列化     ****<ul>
<li>请求数据校验</li>
<li>QuerySet序列化</li>
</ul>
</li>
<li>分页        **</li>
<li>路由        **</li>
<li>视图        **</li>
<li>渲染器     *</li>
</ul>
<h2 id="版本"><a href="#版本" class="headerlink" title="版本"></a>版本</h2><h3 id="BaseVersioning使用（version在url中以get参数形式传递）"><a href="#BaseVersioning使用（version在url中以get参数形式传递）" class="headerlink" title="BaseVersioning使用（version在url中以get参数形式传递）"></a>BaseVersioning使用（version在url中以get参数形式传递）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.versioning <span class="keyword">import</span> BaseVersioning</span><br><span class="line"></span><br><span class="line"><span class="comment"># http://127.0.0.1:8000/order/?token=49713936b12fe71833dcfbbc9ce9b81e&amp;version=v1</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ParameVersion</span>(<span class="title class_ inherited__">BaseVersioning</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">determine_version</span>(<span class="params">self, request, *args, **kwargs</span>):</span><br><span class="line">        version = request.query_params.get(<span class="string">&#x27;version&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> version</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">OrderView</span>(<span class="title class_ inherited__">APIView</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    订单相关业务</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="comment"># 全局认证前提下，若不需要认证局部处理方案， 设置authentication_classes为[]</span></span><br><span class="line">    authentication_classes = [Authication, ]</span><br><span class="line">    <span class="comment"># 设置权限，只有SVIP才可以访问订单</span></span><br><span class="line">    <span class="comment"># permission_classes = [MyPermission, ]</span></span><br><span class="line">    throttle_classes = [UserThrottle, ]</span><br><span class="line"></span><br><span class="line">    versioning_class = ParameVersion</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">REST_FRAMEWORK = &#123;</span><br><span class="line">    <span class="string">&#x27;DEFAULT_VERSION&#x27;</span>: <span class="string">&#x27;v1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;ALLOWED_VERSIONS&#x27;</span>: [<span class="string">&#x27;v1&#x27;</span>, <span class="string">&#x27;v2&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;VERSION_PARAM&#x27;</span>: <span class="string">&#x27;version&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="QueryParameterVersioning-控制版本范围"><a href="#QueryParameterVersioning-控制版本范围" class="headerlink" title="QueryParameterVersioning 控制版本范围"></a>QueryParameterVersioning 控制版本范围</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">versioning_clas = QueryParameterVersioning</span><br><span class="line"></span><br><span class="line">REST_FRAMEWORK = &#123;</span><br><span class="line">    &#x27;DEFAULT_VERSION&#x27;: &#x27;v1&#x27;,</span><br><span class="line">    &#x27;ALLOWED_VERSIONS&#x27;: [&#x27;v1&#x27;, &#x27;v2&#x27;],</span><br><span class="line">    &#x27;VERSION_PARAM&#x27;: &#x27;version&#x27;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="URLPathVersioning（通过url路径来控制版本）"><a href="#URLPathVersioning（通过url路径来控制版本）" class="headerlink" title="URLPathVersioning（通过url路径来控制版本）"></a>URLPathVersioning（通过url路径来控制版本）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"># urls.py</span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(&#x27;admin/&#x27;, admin.site.urls),</span><br><span class="line">    path(&#x27;api/v1/auth/&#x27;, AuthView.as_view()),</span><br><span class="line">    re_path(r&#x27;api/(?P&lt;version&gt;[v1|v2]+)/order/&#x27;, OrderView.as_view()),</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">#setting</span><br><span class="line"></span><br><span class="line">&#x27;DEFAULT_VERSION_CLASS&#x27;: &#x27;rest_framework.versioning.URLPathVersioning&#x27;,</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="反向生成url"><a href="#反向生成url" class="headerlink" title="反向生成url"></a>反向生成url</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">urlpatterns = [</span><br><span class="line">    re_path(<span class="string">r&#x27;api/(?P&lt;version&gt;[v1|v2]+)/order/&#x27;</span>, OrderView.as_view(), name=<span class="string">&#x27;order&#x27;</span>),</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取版本</span></span><br><span class="line"><span class="built_in">print</span>(request.version)</span><br><span class="line"><span class="comment"># 获取版本处理对象</span></span><br><span class="line"><span class="built_in">print</span>(request.versioning_scheme)</span><br><span class="line"><span class="comment"># 反向生成url</span></span><br><span class="line">url = request.versioning_scheme.reverse(viewname=<span class="string">&#x27;order&#x27;</span>, request=request)</span><br><span class="line"><span class="built_in">print</span>(url)</span><br></pre></td></tr></table></figure>

<h2 id="解析器"><a href="#解析器" class="headerlink" title="解析器"></a>解析器</h2><ol>
<li>获取用户请求</li>
<li>获取用户请求体</li>
<li>根据用户请求头，然后用parser_classes的请求头进行比较</li>
<li>解析</li>
<li>request.data获取数据 使用方法</li>
</ol>
<h3 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 局部</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ParserView</span>(<span class="title class_ inherited__">APIView</span>):</span><br><span class="line">    <span class="keyword">from</span> rest_framework.parsers <span class="keyword">import</span> JSONParser, FormParser</span><br><span class="line">    parser_classes = [JSONParser, FormParser, ]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">post</span>(<span class="params">self, request, *args, **kwargs</span>):</span><br><span class="line">        <span class="built_in">print</span>(request.data)</span><br><span class="line">        <span class="keyword">return</span> HttpResponse(<span class="string">&#x27;Parser&#x27;</span>) </span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#全局</span></span><br><span class="line">REST_FRAMEWORK = &#123;</span><br><span class="line">    <span class="string">&#x27;DEFAULT_PARSER_CLASSES&#x27;</span>: [<span class="string">&#x27;rest_framework.parsers.JSONParser&#x27;</span>, <span class="string">&#x27;rest_framework.parsers.FormParser&#x27;</span>, ],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="序列化"><a href="#序列化" class="headerlink" title="序列化"></a>序列化</h2><h3 id="serializer-Serializer"><a href="#serializer-Serializer" class="headerlink" title="serializer.Serializer"></a>serializer.Serializer</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">UserInfoSerializer</span>(serializers.Serializer):</span><br><span class="line">    username = serializers.CharField()</span><br><span class="line">    password = serializers.CharField()</span><br><span class="line">    user_type = serializers.IntegerField()</span><br><span class="line">    <span class="comment"># source取需要的字段</span></span><br><span class="line">    <span class="built_in">type</span> = serializers.CharField(source=<span class="string">&#x27;get_user_type_display&#x27;</span>)</span><br><span class="line">    gp = serializers.CharField(source=<span class="string">&#x27;group.title&#x27;</span>)</span><br><span class="line">    <span class="comment"># 自定义取出字段</span></span><br><span class="line">    rls = serializers.SerializerMethodField()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_rls</span>(<span class="params">self, row</span>):</span><br><span class="line">        row_obj_list = row.roles.<span class="built_in">all</span>()</span><br><span class="line">        ret = []</span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> row_obj_list:</span><br><span class="line">            ret.append(&#123;<span class="string">&#x27;id&#x27;</span>: item.<span class="built_in">id</span>, <span class="string">&#x27;title&#x27;</span>: item.title&#125;)</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Create your views here.</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserInfoView</span>(<span class="title class_ inherited__">APIView</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get</span>(<span class="params">self, request, *args, **kwargs</span>):</span><br><span class="line">        user = UserInfo.objects.<span class="built_in">all</span>()</span><br><span class="line">        <span class="comment"># many=True可以显示多个，默认为False</span></span><br><span class="line">        ser = UserInfoSerializer(instance=user, many=<span class="literal">True</span>)</span><br><span class="line">        <span class="comment"># ensure_ascii=False可以正常显示中文</span></span><br><span class="line">        ret = json.dumps(ser.data, ensure_ascii=<span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">return</span> HttpResponse(ret)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="serializers-ModelSerializer"><a href="#serializers-ModelSerializer" class="headerlink" title="serializers.ModelSerializer"></a>serializers.ModelSerializer</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">UserInfoModelSerializer</span>(serializers.ModelSerializer):</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Meta</span>:</span><br><span class="line">        model = UserInfo</span><br><span class="line">        fields = <span class="string">&#x27;__all__&#x27;</span></span><br><span class="line">        depth = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Create your views here.</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserInfoView</span>(<span class="title class_ inherited__">APIView</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get</span>(<span class="params">self, request, *args, **kwargs</span>):</span><br><span class="line">        user = UserInfo.objects.<span class="built_in">all</span>()</span><br><span class="line">        <span class="comment"># many=True可以显示多个，默认为False</span></span><br><span class="line">        ser = UserInfoModelSerializer(instance=user, many=<span class="literal">True</span>)</span><br><span class="line">        <span class="comment"># ensure_ascii=False可以正常显示中文</span></span><br><span class="line">        ret = json.dumps(ser.data, ensure_ascii=<span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">return</span> HttpResponse(ret)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="反向生成url-1"><a href="#反向生成url-1" class="headerlink" title="反向生成url"></a>反向生成url</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">UserInfoModelSerializer</span>(serializers.ModelSerializer):</span><br><span class="line">    <span class="comment"># 获取到该路由的name(反向生成url)</span></span><br><span class="line">    <span class="comment"># 通过lookup_field = &#x27;group_id’获取数据库中该用户组的id</span></span><br><span class="line">    <span class="comment"># 通过lookup_url_kwarg = &#x27;pk’获取路由中该用户组取值的key获取id</span></span><br><span class="line">    <span class="comment"># 在ModelSerializer实例化的时候通过context参数传递reuqest</span></span><br><span class="line"></span><br><span class="line">    group = serializers.HyperlinkedIdentityField(view_name=<span class="string">&#x27;gp&#x27;</span>, lookup_field=<span class="string">&#x27;group_id&#x27;</span>, lookup_url_kwarg=<span class="string">&#x27;pk&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Meta</span>:</span><br><span class="line">        model = UserInfo</span><br><span class="line">        fields = <span class="string">&#x27;__all__&#x27;</span></span><br><span class="line">        depth = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Create your views here.</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserInfoView</span>(<span class="title class_ inherited__">APIView</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get</span>(<span class="params">self, request, *args, **kwargs</span>):</span><br><span class="line">        user = UserInfo.objects.<span class="built_in">all</span>()</span><br><span class="line">        <span class="comment"># many=True可以显示多个，默认为False</span></span><br><span class="line">        <span class="comment"># 使用HyperlinkedIdentityField之后，需要加上context=&#123;&#x27;request&#x27;: request&#125;</span></span><br><span class="line">        ser = UserInfoModelSerializer(instance=user, many=<span class="literal">True</span>, context=&#123;<span class="string">&#x27;request&#x27;</span>: request&#125;)</span><br><span class="line">        <span class="comment"># ensure_ascii=False可以正常显示中文</span></span><br><span class="line">        ret = json.dumps(ser.data, ensure_ascii=<span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">return</span> HttpResponse(ret)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">&#x27;admin/&#x27;</span>, admin.site.urls),</span><br><span class="line">    path(<span class="string">&#x27;user/&#x27;</span>, UserInfoView.as_view()),</span><br><span class="line">    re_path(<span class="string">r&#x27;group/(?P&lt;pk&gt;\d+)&#x27;</span>, GroupView.as_view(), name=<span class="string">&#x27;gp&#x27;</span>),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h3 id="自定义验证器"><a href="#自定义验证器" class="headerlink" title="自定义验证器"></a>自定义验证器</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyValidator</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, base</span>):</span><br><span class="line">        self.base = <span class="built_in">str</span>(base)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self, value</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> value.endswith(self.base):</span><br><span class="line">            msg = <span class="string">&#x27;字段必须以%s结尾&#x27;</span> % self.base</span><br><span class="line">            <span class="keyword">raise</span> serializers.ValidationError(msg)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">set_context</span>(<span class="params">self, serializer_field</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserGroupSerializer</span>(serializers.Serializer):</span><br><span class="line">    title = serializers.CharField(error_messages=&#123;<span class="string">&#x27;required&#x27;</span>: <span class="string">&#x27;标题不能缺失&#x27;</span>, <span class="string">&#x27;blank&#x27;</span>: <span class="string">&#x27;标题内容不能为空&#x27;</span>&#125;,</span><br><span class="line">                                  validators=[MyValidator(<span class="string">&#x27;组&#x27;</span>), ])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserGroupView</span>(<span class="title class_ inherited__">APIView</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">post</span>(<span class="params">self, request, *args, **kwargs</span>):</span><br><span class="line">        ser = UserGroupSerializer(data=request.data)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ser.is_valid():</span><br><span class="line">            <span class="built_in">print</span>(ser.validated_data[<span class="string">&#x27;title&#x27;</span>])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(ser.errors)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> HttpResponse(<span class="string">&#x27;POST&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="钩子方法验证"><a href="#钩子方法验证" class="headerlink" title="钩子方法验证"></a>钩子方法验证</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">UserGroupSerializer</span>(serializers.Serializer):</span><br><span class="line">    title = serializers.CharField(required=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 钩子方法进行验证</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">validate_title</span>(<span class="params">self, value</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> value.endswith(<span class="string">&#x27;s&#x27;</span>):</span><br><span class="line">            <span class="keyword">return</span> serializers.ValidationError(<span class="string">&#x27;必须以s结尾&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> value</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserGroupView</span>(<span class="title class_ inherited__">APIView</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">post</span>(<span class="params">self, request, *args, **kwargs</span>):</span><br><span class="line">        ser = UserGroupSerializer(data=request.data)</span><br><span class="line">        ret = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">if</span> ser.is_valid():</span><br><span class="line">            <span class="built_in">print</span>(ser.validated_data[<span class="string">&#x27;title&#x27;</span>])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(ser.errors)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> HttpResponse(<span class="string">&#x27;POST&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="分页-PageNumberPagination-LimitOffsetPagination"><a href="#分页-PageNumberPagination-LimitOffsetPagination" class="headerlink" title="分页(PageNumberPagination,LimitOffsetPagination)"></a>分页(PageNumberPagination,LimitOffsetPagination)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">PageSerializer</span>(serializers.ModelSerializer):</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Meta</span>:</span><br><span class="line">        model = Role</span><br><span class="line">        fields = <span class="string">&#x27;__all__&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyPagination</span>(<span class="title class_ inherited__">PageNumberPagination</span>):</span><br><span class="line">    page_size = <span class="number">2</span>  <span class="comment"># 每个页面默认显示个数</span></span><br><span class="line">    page_size_query_param = <span class="string">&#x27;size&#x27;</span>  <span class="comment"># 调节每个页面的显示个数</span></span><br><span class="line">    max_page_size = <span class="number">4</span></span><br><span class="line">    page_query_param = <span class="string">&#x27;page&#x27;</span>  <span class="comment"># 调节跳转页码</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PageView</span>(<span class="title class_ inherited__">APIView</span>):</span><br><span class="line"></span><br><span class="line">    <span class="comment"># http://127.0.0.1:8000/page/?size=4&amp;page=2</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get</span>(<span class="params">self, request, *args, **kwargs</span>):</span><br><span class="line">        <span class="comment"># 获取数据</span></span><br><span class="line">        roles = Role.objects.<span class="built_in">all</span>()</span><br><span class="line">        <span class="comment"># 分页操作</span></span><br><span class="line">        pg = MyPagination()</span><br><span class="line">        page_roles = pg.paginate_queryset(queryset=roles, request=request, view=self)</span><br><span class="line">        <span class="comment"># 序列化数据</span></span><br><span class="line">        ser = PageSerializer(instance=page_roles, many=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Response(ser.data)</span><br></pre></td></tr></table></figure>

<h3 id="全局"><a href="#全局" class="headerlink" title="全局"></a>全局</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">REST_FRAMEWORK = &#123;</span><br><span class="line">    <span class="string">&quot;PAGE_SIZE&quot;</span>: <span class="number">2</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PageView</span>(<span class="title class_ inherited__">APIView</span>):</span><br><span class="line"></span><br><span class="line">    <span class="comment"># http://127.0.0.1:8000/page/?size=4&amp;page=2</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get</span>(<span class="params">self, request, *args, **kwargs</span>):</span><br><span class="line">        <span class="comment"># 获取数据</span></span><br><span class="line">        roles = Role.objects.<span class="built_in">all</span>()</span><br><span class="line">        <span class="comment"># 分页操作</span></span><br><span class="line">        pg = PageNumberPagination()</span><br><span class="line">        page_roles = pg.paginate_queryset(queryset=roles, request=request, view=self)</span><br><span class="line">        <span class="comment"># 序列化数据</span></span><br><span class="line">        ser = PageSerializer(instance=page_roles, many=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Response(ser.data)</span><br></pre></td></tr></table></figure>

<h2 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h2><h3 id="GenericAPIView"><a href="#GenericAPIView" class="headerlink" title="GenericAPIView"></a>GenericAPIView</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># setting.py</span></span><br><span class="line">REST_FRAMEWORK = &#123;</span><br><span class="line">    <span class="string">&quot;PAGE_SIZE&quot;</span>: <span class="number">2</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># url.py</span></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">&#x27;v1/&#x27;</span>, View1View.as_view()),</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> rest_framework.generics <span class="keyword">import</span> GenericAPIView</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PageSerializer</span>(serializers.ModelSerializer):</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Meta</span>:</span><br><span class="line">        model = Role</span><br><span class="line">        fields = <span class="string">&#x27;__all__&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">View1View</span>(<span class="title class_ inherited__">GenericAPIView</span>):</span><br><span class="line">    <span class="comment"># queryset：数据库中获取值</span></span><br><span class="line">    <span class="comment"># serializer_class：序列化的类方法</span></span><br><span class="line">    <span class="comment"># pagination_class：分页中的类方法</span></span><br><span class="line"></span><br><span class="line">    queryset = Role.objects.<span class="built_in">all</span>()</span><br><span class="line">    serializer_class = PageSerializer</span><br><span class="line">    pagination_class = PageNumberPagination</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get</span>(<span class="params">self, request, *args, **kwargs</span>):</span><br><span class="line">        <span class="comment"># 获取数据</span></span><br><span class="line">        roles = self.get_queryset()</span><br><span class="line">        <span class="comment"># 分页操作</span></span><br><span class="line">        page_roles = self.paginate_queryset(roles)</span><br><span class="line">        <span class="comment"># 序列化数据</span></span><br><span class="line">        ser = self.get_serializer(instance=page_roles, many=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Response(ser.data)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="GenericViewSet"><a href="#GenericViewSet" class="headerlink" title="GenericViewSet"></a>GenericViewSet</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># url.py</span></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">&#x27;v1/&#x27;</span>, View1View.as_view(&#123;<span class="string">&#x27;get&#x27;</span>: <span class="string">&#x27;list&#x27;</span>&#125;)),</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> rest_framework.viewsets <span class="keyword">import</span> GenericViewSet</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">View1View</span>(<span class="title class_ inherited__">GenericViewSet</span>):</span><br><span class="line">    <span class="comment"># queryset：数据库中获取值</span></span><br><span class="line">    <span class="comment"># serializer_class：序列化的类方法</span></span><br><span class="line">    <span class="comment"># pagination_class：分页中的类方法</span></span><br><span class="line"></span><br><span class="line">    queryset = Role.objects.<span class="built_in">all</span>().order_by(<span class="string">&#x27;id&#x27;</span>)</span><br><span class="line">    serializer_class = PageSerializer</span><br><span class="line">    pagination_class = PageNumberPagination</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">list</span>(<span class="params">self, request, *args, **kwargs</span>):</span><br><span class="line">        <span class="comment"># 获取数据</span></span><br><span class="line">        roles = self.get_queryset()</span><br><span class="line">        <span class="comment"># 分页操作</span></span><br><span class="line">        page_roles = self.paginate_queryset(roles)</span><br><span class="line">        <span class="comment"># 序列化数据</span></span><br><span class="line">        ser = self.get_serializer(instance=page_roles, many=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Response(ser.data)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="ModelViewSet"><a href="#ModelViewSet" class="headerlink" title="ModelViewSet"></a>ModelViewSet</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">urlpatterns = [</span><br><span class="line">    re_path(<span class="string">r&#x27;v1/(?P&lt;pk&gt;\d+)&#x27;</span>, View1View.as_view(&#123;<span class="string">&#x27;get&#x27;</span>: <span class="string">&#x27;retrieve&#x27;</span>, <span class="string">&#x27;post&#x27;</span>: <span class="string">&#x27;create&#x27;</span>, <span class="string">&#x27;delete&#x27;</span>: <span class="string">&#x27;destroy&#x27;</span>, <span class="string">&#x27;put&#x27;</span>: <span class="string">&#x27;update&#x27;</span>&#125;)),</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> rest_framework.viewsets <span class="keyword">import</span> ModelViewSet</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">View1View</span>(<span class="title class_ inherited__">ModelViewSet</span>):</span><br><span class="line">    <span class="comment"># queryset：数据库中获取值</span></span><br><span class="line">    <span class="comment"># serializer_class：序列化的类方法</span></span><br><span class="line">    <span class="comment"># pagination_class：分页中的类方法</span></span><br><span class="line"></span><br><span class="line">    queryset = Role.objects.<span class="built_in">all</span>()</span><br><span class="line">    serializer_class = PageSerializer</span><br><span class="line">    pagination_class = PageNumberPagination</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path, re_path, include</span><br><span class="line"><span class="keyword">from</span> rest_framework <span class="keyword">import</span> routers</span><br><span class="line"><span class="keyword">from</span> api.views <span class="keyword">import</span> View1View</span><br><span class="line"></span><br><span class="line">router = routers.DefaultRouter()</span><br><span class="line">router.register(<span class="string">r&#x27;view&#x27;</span>, View1View)</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">&#x27;admin/&#x27;</span>, admin.site.urls),</span><br><span class="line">    <span class="comment"># http://127.0.0.1:8000/api/view/</span></span><br><span class="line">    <span class="comment"># http://127.0.0.1:8000/api/view/1/</span></span><br><span class="line">    re_path(<span class="string">r&#x27;api/&#x27;</span>, include(router.urls)),</span><br><span class="line"></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> rest_framework.viewsets <span class="keyword">import</span> ModelViewSet</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">View1View</span>(<span class="title class_ inherited__">ModelViewSet</span>):</span><br><span class="line">    <span class="comment"># queryset：数据库中获取值</span></span><br><span class="line">    <span class="comment"># serializer_class：序列化的类方法</span></span><br><span class="line">    <span class="comment"># pagination_class：分页中的类方法</span></span><br><span class="line"></span><br><span class="line">    queryset = Role.objects.<span class="built_in">all</span>()</span><br><span class="line">    serializer_class = PageSerializer</span><br><span class="line">    pagination_class = PageNumberPagination</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="渲染器"><a href="#渲染器" class="headerlink" title="渲染器"></a>渲染器</h2><h3 id="全局配置"><a href="#全局配置" class="headerlink" title="全局配置"></a>全局配置</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">REST_FRAMEWORK = &#123;</span><br><span class="line">    <span class="string">&quot;PAGE_SIZE&quot;</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="string">&quot;DEFAULT_RENDERER_CLASSES&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;rest_framework.renderers.JSONRenderer&quot;</span>,</span><br><span class="line">        <span class="string">&quot;rest_framework.renderers.BrowsableAPIRenderer&quot;</span>,</span><br><span class="line">    ],</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="单独配置"><a href="#单独配置" class="headerlink" title="单独配置"></a>单独配置</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">View1View</span>(<span class="title class_ inherited__">ModelViewSet</span>):</span><br><span class="line">    <span class="comment"># queryset：数据库中获取值</span></span><br><span class="line">    <span class="comment"># serializer_class：序列化的类方法</span></span><br><span class="line">    <span class="comment"># pagination_class：分页中的类方法</span></span><br><span class="line">    <span class="comment"># http://127.0.0.1:8000/api/view/?format=admin</span></span><br><span class="line">    renderer_classes = [JSONRenderer, BrowsableAPIRenderer, AdminRenderer]</span><br><span class="line"></span><br><span class="line">    queryset = Role.objects.<span class="built_in">all</span>()</span><br><span class="line">    serializer_class = PageSerializer</span><br><span class="line">    pagination_class = PageNumberPagination</span><br></pre></td></tr></table></figure>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/rest-framework/" rel="tag">rest_framework</a></li></ul>

    </footer>
  </div>

   
    
</article>

    
  </article>
  

  
  <nav class="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">下一页</a>
  </nav>
  
</section>
</div>

      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2015-2022
        <i class="ri-heart-fill heart_icon"></i> Alin Jiong
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>Visitors:<span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>Views:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>    
    </main>
    <div class="float_btns">
      <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

    </div>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-side.svg" alt="Alin"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about">关于我</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="Search">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="/images/alipay.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="/images/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-3.6.0.min.js"></script>
 
<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->

<script src="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.staticfile.org/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/default-skin/default-skin.min.css">
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.js"></script>
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->
 
<script src="/js/busuanzi-2.3.pure.min.js"></script>
 
<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->
 
<link rel="stylesheet" href="/css/clipboard.css">
 <script src="https://cdn.staticfile.org/clipboard.js/2.0.10/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->

<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
    

  </div>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>

</html>